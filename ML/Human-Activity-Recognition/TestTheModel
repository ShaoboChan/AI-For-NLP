from __future__ import print_function
import argparse
import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
from torch.utils.data.sampler import SubsetRandomSampler
from torchvision import datasets, transforms
from torch.utils.data.dataset import Dataset
import runpy
import pandas as pd
import numpy as np
import os


class HARmodel(nn.Module):
    def __init__(self):
        super(HARmodel, self).__init__()
        self.layer1 = nn.Sequential(
            nn.Conv1d(1, 100, 2),
            nn.BatchNorm1d(100),
            nn.ReLU(),
            # nn.Dropout(),
            nn.MaxPool1d(8))
        self.layer2 = nn.Sequential(
            nn.Conv1d(100, 50, 2),
            nn.BatchNorm1d(50),
            nn.ReLU(),
            # nn.Dropout(),
            nn.MaxPool1d(8))
        self.fc = nn.Linear(400, 6)

    def forward(self, x):
        # input.shape:(16,1,425)
        out = self.layer1(x)
        out = self.layer2(out)
        out = out.view(out.size(0), -1)  # torch.Size([16, 400])
        # self.len_Linear=len(out)
        out = self.fc(out)
        return out

def restore():
    torch.load('model3/classi_epoch_79.pt')
def restore_param():
    net1=HARmodel()

    return net1

model1=restore_param()
model1.eval()
model1.load_state_dict(torch.load('model3/classi_epoch_79.pt'))
x=[[[-0.9947879860120965, -0.9947837292092776, -0.9947698169519585, -0.9947587408801511, -0.9947620114929776, -0.9947705259097768, -0.9947629754385756, -0.994766540291558, -0.9947707254598903, -0.994772994546101, -0.9947730347064345, -0.9947649983686726, -0.9948188702791204, -0.9948081313467878, -0.994773070225354, -0.9947441641520932, -0.9947138727832364, -0.994740429937274, -0.9947707304440419, -0.9947488221888545, -0.9947548313905261, -0.9947684247280267, -0.9947302622375966, -0.9947309637977153, -0.9947288406524938, -0.9947542190220712, -0.9947592649433893, -0.9947728955111285, -0.994770744010008, -0.9947449769445916, -0.9947318768703379, -0.9947461029002406, -0.9947664006010135, -0.9947532455092155, -0.9947543339399425, -0.9947662660692359, -0.9947723742544436, -0.9947658464326926, -0.9947659444816469, -0.9947660167237471, -0.994893470098109, -0.9948395321976465, -0.9947391852887607, -0.9943842350141601, -0.9943631871740636, -0.994363682144166, -0.9944509585282749, -0.9944114523389618, -0.994368988054656, -0.9941846498442278, -0.9941418058293089, -0.9941378015197346, -0.9954423477222951, -0.9953617723858226, -0.9953696852785864, -0.9936795669612479, -0.9719640648135895, -0.9710525862414433, -0.9715635249675145, -0.9940782550759653, -0.9939819364161098, -0.9939801371926311, -0.9947267817012769, -0.9947267101990142, -0.9947267231082921, -0.9947632632495048, -0.9947672390469315, -0.9947711457804946, -0.9947720798805815, -0.9947635416784233, -0.9947679526960175, -0.9947724941772219, -0.9947711183230378, -0.9947623976852338, -0.9947664009139736, -0.9947716563754544, -0.9947715297694656, -0.9947698407749446, -0.9947698371563759, -0.9947687996280599, -0.9948188703205177, -0.9948081313012949, -0.9947649983545797, -0.9947448090030637, -0.9947485755842519, -0.9947694296905837, -0.9947466054272851, -0.9947497733500136, -0.9947711010640665, -0.9947720133286495, -0.9947728497512668, -0.9947571707488543, -0.9948581651848875, -0.9948409758692898, -0.9947739243344539, -0.9946839084047624, -0.994371571687551, -0.9945196167030751, -0.9947622746158629, -0.9947198846595835, -0.9947249077409004, -0.9947693111006864, -0.9947276594109333, -0.9947284036108065, -0.9947264704727612, -0.994754000475833, -0.9947559058375623, -0.9947675016410558, -0.9947727930943481, -0.9947518631362694, -0.9947506021090032, -0.9947632854868643, -0.9947717436146375, -0.9947536782995487, -0.9947545681494268, -0.9947667007514283, -0.9947730038395853, -0.9947659094518104, -0.9947672524565926, -0.9947678573142962, -0.9947687724595212, -0.9947776380243922, -0.994775567881986, -0.9947396833374889, -0.9947458931568889, -0.9946869698205218, -0.9947553041140066, -0.9947539881728987, -0.9947000411772746, -0.9947205557350771, -0.9947389981238178, -0.9946561814115573, -0.9948492975925932, -0.9948364164988264, -0.9949170822939962, -0.9946463114440238, -0.9946184277345288, -0.9946693689931807, -0.9937593840139632, -0.9947342113265977, -0.9947338557339167, -0.9946111688667014, -0.9947321295993764, -0.9947326223863266, -0.9947315747247164, -0.994763521733748, -0.9947665602435385, -0.9947701739024444, -0.9947721687024383, -0.9947643151707094, -0.9947691196729176, -0.9947723573697611, -0.9947704878310676, -0.9947629017528635, -0.9947672668201846, -0.9947718636950856, -0.9947717366349498, -0.9947692289745017, -0.9947700575130236, -0.9947719254355091, -0.9947182629314463, -0.9948136758483752, -0.9946670147001675, -0.9929119302805756, -0.9930575386938023, -0.9909544196813042, -0.9937261959076514, -0.9934243592796044, -0.9920345064330737, -0.9906665280537528, -0.9915774158838955, -0.986850843938722, -0.9986415154609016, -0.9981111165196255, -1.0, -0.988757352348517, -0.5208964766100892, -0.5922704315891514, 1.0, -0.9927726355773694, -0.9920952019121286, -0.9884896663645473, -0.9947337326536666, -0.9947324349161144, -0.9947327745929864, -0.9947665656450949, -0.9947694956864607, -0.9947699910985162, -0.9947726167369382, -0.9947679658360153, -0.9947706146380885, -0.9947696150638301, -0.994772532757599, -0.9947634862700511, -0.9947678630322514, -0.9947727367946282, -0.9947710494397991, -0.9947681832724209, -0.9947704892971156, -0.9947717856757128, -0.9947611957562835, -0.9947638293876443, -0.994764878061795, -0.9947440094595179, -0.9947730316006381, -0.9947730346609416, -0.9947419057861041, -0.9947564528579339, -0.994728703230294, -0.9947473555497299, -0.9947375996277714, -0.994750415533667, -0.9947673685274857, -0.9946287233028722, -0.9947346021189961, -0.9947464301846738, -0.9945726259257696, -0.9947381571927233, -0.9947730346609416, -0.9916764814478027, -0.9947109106592233, -0.9947255033726818, -0.9947613350687983, -0.9947646837616217, -0.9947701007185851, -0.9947722097365745, -0.9947456736995824, -0.9947593411781557, -0.9947622995800335, -0.9947290575489612, -0.9947727446510065, -0.9947730346609416, -0.9946432358958491, -0.9947490087722316, -0.9947268224159077, -0.9947507560817846, -0.9947448939973914, -0.9947549428322434, -0.9947680015184048, -0.9947356759617888, -0.9947617437825117, -0.9947647883813384, -0.994715877458229, -0.9947647580558745, -0.9947730346609416, -0.9945617000639094, -0.9947559762252904, -0.9947305106495242, -0.994762074322417, -0.9947657470510158, -0.9947702118694383, -0.9947724630707488, -0.9942935335762236, -0.994611131837855, -0.9946929752893335, -0.9939216340257341, -0.9946037129596733, -0.9947730346609416, -0.9592464925804385, -0.9946076409885294, -0.9947307695156419, -0.994763809921197, -0.9947680800412986, -0.9947708306319378, -0.994772503580005, -0.9947654139754857, -0.994767320015782, -0.9947715857641704, -0.994768878806437, -0.9947701002531961, -0.994772085851793, -0.9947704644028925, -0.9947708905137318, -0.994772658821528, -0.99477004775239, -0.9947707056949393, -0.9947725372806706, -0.9947581075494392, -0.9947623553589056, -0.994769823397769, -0.9947582504335549, -0.9947626156353362, -0.9947673256254111, -0.9947726204801176, -0.9947656266403526, -0.9947676042098683, -0.9947714533369942, -0.9947340945616495, -0.9947339480884305, -0.9947346854368515, -0.9947655711051904, -0.9947676950099236, -0.9947714290293553, -0.994763193879303, -0.9947658439802605, -0.9947709771172347, -0.9947691355615701, -0.9947640895472303, -0.9947698749726823, -0.9947634279840334, -0.9947679139116563, -0.9947652546524046, -0.9947584438457125, -0.9947601587296815, -0.9947628645691041, -0.9947656505657487, -0.994767667682031, -0.9947687040663528, -0.9947692727313205, -0.9947697773177833, -0.994759301287697, -0.9947642575674265, -0.9947681858741918, -0.9947695250245518, -0.9947617794275617, -0.9947688554493719, -0.9947625670301169, -0.9947636499415493, -0.9947653810194761, -0.9947672392240764, -0.9947687449278617, -0.9947696855282191, -0.9947701962457515, -0.9947705319293461, -0.9947631084858332, -0.9947663101217763, -0.9947692152280404, -0.9947703640875488, -0.9947647093038047, -0.9947697896577946, -0.9947699127726531, -0.9947703674308312, -0.9947710785878228, -0.9947717845696787, -0.9947722096675412, -0.994772319396741, -0.9947723755196626, -0.994772479582349, -0.9947701401017421, -0.9947714315787507, -0.9947722645321412, -0.9947724275510058, -0.9947707858402465, -0.9947723460415735, -0.9947546665916132, -0.9947581936821741, -0.9947702970314032, -0.9947591149967956, -0.9947622519707037, -0.9947705467091733, -0.9947689606989595, -0.9947690678111752, -0.9947721183459165, -0.9947679572260003, -0.994768483118742, -0.9947726832144431, -0.9947277605006852, -0.994738356499558, -0.9947651027368353, -0.9947370879833073, -0.994699791067211, -0.9947266106459214, -0.9947711509886609, -0.9947515121745233, -0.9947545491193743, -0.9947695390657175, -0.9947353354244408, -0.9947351808646089, -0.994736409586307, -0.9947503975808134, -0.9947556955802498, -0.9947690686988885, -0.9947443332886932, -0.9947505194157595, -0.9947680821300279, -0.994767134307187, -0.9947663810231234, -0.9947680397467287, -0.9947649463315463, -0.9947657421086481, -0.9947692303861185, -0.994729250809332, -0.9947367811163244, -0.9947483417987645, -0.9947592293612785, -0.9947642708991149, -0.994764483402211, -0.994765461190243, -0.9947672990499058, -0.9947330159628283, -0.9947537855800215, -0.9947643771506629, -0.9947663801200745, -0.9947434007714249, -0.9947653786353687, -0.9947393402231004, -0.9947443385691348, -0.9947521769481783, -0.9947601880906614, -0.9947655822830085, -0.9947671111308193, -0.9947672194246115, -0.9947678778817839, -0.9947418393961176, -0.9947561825194199, -0.9947663467069139, -0.9947675486531977, -0.9947490109577687, -0.9947669476800558, -0.9947654458191979, -0.9947671737878487, -0.9947698168944087, -0.9947722041687342, -0.9947718347066662, -0.9947713568973301, -0.9947718294954065, -0.9947723788474393, -0.9947663098035233, -0.9947710105315715, -0.9947715958019981, -0.9947721041714229, -0.9947686601675474, -0.9947718499867105, -0.9947704471826762, -0.9947696741800844, -0.9947700066939161, -0.9947718795082519, -0.9947718798893734, -0.9947727670864844, -0.9947718734494587, -0.9947722368544064, -0.9947728469065398, -0.9947719077353365, -0.9947720584883539, -0.994770496727767, -0.994768781242987, -0.9947684344171724, -0.9947697131561858, -0.9947640587347937, -0.9947719252939149, -0.9947712866305471, -0.9947717512322599, -0.9947707731208651, -0.9947711782673778, -0.9947725859592003, -0.9947387542445862, -0.9947383887130978, -0.9947377561003911, -0.9947709079519642, -0.994770734539057, -0.9947713871945827, -0.9947699486669993, -0.9947692905899029, -0.9947699838371435, -0.9947723851074807, -0.9947620326977608, -0.994768348192848, -0.9947666207083039, -0.9947686125368724, -0.9947654015110764, -0.9947688132552934, -0.9947689930805098, -0.9947693111522644, -0.9947697396684183, -0.9947702395310358, -0.9947707612325001, -0.9947712450250569, -0.9947716231997281, -0.9947689031679016, -0.9947695254103414, -0.994770500381768, -0.9947714341123925, -0.9947692142891215, -0.9947709672470803, -0.994768445952056, -0.9947685137001006, -0.9947686465896239, -0.9947688548467297, -0.994769148498768, -0.9947695336338166, -0.9947700093785499, -0.9947705660813989, -0.9947684798260783, -0.9947687507181768, -0.9947693410662923, -0.9947702877299743, -0.9947686152721276, -0.9947698143981334, -0.9947704797361503, -0.9947703874328687, -0.9947702371542269, -0.994770060705381, -0.9947698940772647, -0.9947697709713026, -0.9947697166398223, -0.9947697411534013, -0.9947704335845095, -0.9947701489298039, -0.9947698325242836, -0.9947697288966119, -0.9947702912571567, -0.9947697807104477, -0.9947645603434958, -0.9947699481203452, -0.994770707798158, -0.9947683164072659, -0.9947594645606225, -0.9947730346609416, -0.9947617608032453, -0.9947673025413429, -0.9947332859269783, -0.994766249610782, -0.9947634590973137, -0.9947702112569964, -0.9947631422277609, -0.9947579682897943, -0.9947653790297897, -0.9947698067964602, -0.994766065793696, -0.9947442449594681, -0.9947730346609416, -0.9947335211624095, -0.9947600529860665, -0.9947338711490574, -0.9947586398102048, -0.9947541576447431, -0.9947683641884163, -0.9947644937598121, -0.9947671609924286, -0.9947721918460014, -0.9947723259163881, -0.9947686713547006, -0.9947661319218764, -0.9947730346609416, -0.9947681460971943, -0.9947715718171409, -0.9947378219451627, -0.994769583291409, -0.9947670440877852, -0.9947703146089651, -0.9947641752139592, -0.9947466491947702, -0.9947633883553868, -0.9947636837117335, -0.9947602518920956, -0.9947335988256107, -0.9947730346609416, -0.9946638140366255, -0.9947545254334983, -0.9947384172002056, -0.9947533167432762, -0.994743240139829, -0.9947725262970601, -0.9947622287046028, -0.9947666188775094, -0.9947666973565612, -0.9947667978900882, -0.9947663644675167, -0.9947689409683599, -0.9947688109719549, -0.994768886205551]]]
x=np.array(x)
x=torch.from_numpy(x).float()
y=model1(x)
# pre=torch.max(y.data,1)
# print(pre)
# print(model1)
print(y)
probability = torch.nn.functional.softmax(y,dim=1)#计算softmax，即该数据属于各类的概率
max_value,index = torch.max(probability,1)#找到最大概率对应的索引号，该动作即为该索引号对应的类别
print(index)
